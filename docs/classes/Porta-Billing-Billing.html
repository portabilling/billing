<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
            <title>PortaBilling API</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <base href="../">
    <link rel="icon" href="images/favicon.ico"/>
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link rel="preconnect" href="https://fonts.gstatic.com">
        <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/themes/prism-okaidia.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.css">
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
        <script src="js/search.js"></script>
        <script defer src="js/searchIndex.js"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header phpdocumentor-section">
    <h1 class="phpdocumentor-title"><a href="" class="phpdocumentor-title__link">PortaBilling API</a></h1>
    <input class="phpdocumentor-header__menu-button" type="checkbox" id="menu-button" name="menu-button" />
    <label class="phpdocumentor-header__menu-icon" for="menu-button">
        <i class="fas fa-bars"></i>
    </label>
    <section data-search-form class="phpdocumentor-search">
    <label>
        <span class="visually-hidden">Search for</span>
        <svg class="phpdocumentor-search__icon" width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="7.5" cy="7.5" r="6.5" stroke="currentColor" stroke-width="2"/>
            <line x1="12.4892" y1="12.2727" x2="19.1559" y2="18.9393" stroke="currentColor" stroke-width="3"/>
        </svg>
        <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
    </label>
</section>

    <nav class="phpdocumentor-topnav">
    <ul class="phpdocumentor-topnav__menu">
        </ul>
</nav>
</header>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>
<aside class="phpdocumentor-column -four phpdocumentor-sidebar">
                    <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="namespaces/porta.html" class="">Porta</a>
</h4>
    <ul class="phpdocumentor-list">
                    <li>
                <a href="namespaces/porta-billing.html" class="">Billing</a>
                
            </li>
            </ul>

                        </section>
                <section class="phpdocumentor-sidebar__category">
            <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/Billing.html" class="">Billing</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/Configuration.html" class="">Configuration</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/Exceptions.html" class="">Exceptions</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/ClientAdaptors.html" class="">ClientAdaptors</a>
</h4>

                                    <h4 class="phpdocumentor-sidebar__root-namespace">
    <a href="packages/Cache.html" class="">Cache</a>
</h4>

                        </section>
            
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
            <li class="phpdocumentor-breadcrumb"><a href="namespaces/porta.html">Porta</a></li>
            <li class="phpdocumentor-breadcrumb"><a href="namespaces/porta-billing.html">Billing</a></li>
    </ul>

    <article class="phpdocumentor-element -class">
        <h2 class="phpdocumentor-content__title">
    Billing

        <span class="phpdocumentor-element__extends">
        extends <a href="classes/Porta-Billing-Components-BillingBase.html"><abbr title="\Porta\Billing\Components\BillingBase">BillingBase</abbr></a>
    </span>
    
            <div class="phpdocumentor-element__package">
            in package
            <ul class="phpdocumentor-breadcrumbs">
                                    <li class="phpdocumentor-breadcrumb"><a href="packages/Billing.html">Billing</a></li>
                            </ul>
        </div>
    
    
    </h2>

        <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Billing.php"><a href="files/billing.html"><abbr title="Billing.php">Billing.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">32</span>

    </aside>

            <p class="phpdocumentor-summary">Billing API wrapper</p>

    <section class="phpdocumentor-description"><p>The class is intended to provide interface to Portaone billing API. It handles
authorisation, access token management and API call handling.
It needs <a href="classes/Porta-Billing-Interfaces-ConfigInterface.html"><abbr title="\Porta\Billing\Interfaces\ConfigInterface">ConfigInterface</abbr></a> object as source of every configuraton aspect</p>
<p>See 'API documentation' section on <a href="https://docs.portaone.com">https://docs.portaone.com</a></p>
</section>








<h3 id="toc">
    Table of Contents
    <a href="#toc" class="headerlink"><i class="fas fa-link"></i></a>
</h3>

<dl class="phpdocumentor-table-of-contents">
            <dt class="phpdocumentor-table-of-contents__entry -constant -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#constant_DATETIME_FORMAT">DATETIME_FORMAT</a>
    <span>
        &nbsp;= &#039;Y-m-d H:i:s&#039;                            </span>
</dt>
<dd>Billing API datetime format</dd>

                        <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method___construct">__construct()</a>
    <span>
                                &nbsp;: mixed    </span>
</dt>
<dd>Setup the class, load (if any) saved session state and get it ready to use</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Billing.html#method_call">call()</a>
    <span>
                                &nbsp;: array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Perform billing API call.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Billing.html#method_callAsync">callAsync()</a>
    <span>
                                &nbsp;: mixed    </span>
</dt>
<dd>Performs async call to the billing and returns promise</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Billing.html#method_callConcurrent">callConcurrent()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Perform bulk billig call, running multiple concurrent requests at once.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method_checkSession">checkSession()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Does active sesson check to billing server, relogin if required</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method_getUsername">getUsername()</a>
    <span>
                                &nbsp;: string|null    </span>
</dt>
<dd>Return current user login name</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method_isSessionPresent">isSessionPresent()</a>
    <span>
                                &nbsp;: bool    </span>
</dt>
<dd>Returns true if session data exit and not expired</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method_login">login()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Do login and setup the session.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method_logout">logout()</a>
    <span>
                                &nbsp;: void    </span>
</dt>
<dd>Closes the session explicitly.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Billing.html#method_makeRequest">makeRequest()</a>
    <span>
                                &nbsp;: <abbr title="\Psr\Http\Message\RequestInterface">RequestInterface</abbr>    </span>
</dt>
<dd>Creates PSR-7 Request object for API call</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Billing.html#method_processResponse">processResponse()</a>
    <span>
                                &nbsp;: array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Process billing response, given as Response object</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method_timeToBilling">timeToBilling()</a>
    <span>
                                &nbsp;: string    </span>
</dt>
<dd>Return billing API string at UTC fro given Datetime object</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/Porta-Billing-Components-BillingBase.html#method_timeToLocal">timeToLocal()</a>
    <span>
                                &nbsp;: <abbr title="\DateTime">DateTime</abbr>    </span>
</dt>
<dd>Convert billing-supplied UTC time string to DateTime object with target
timezone</dd>

        </dl>



        
    <section class="phpdocumentor-constants">
        <h3 class="phpdocumentor-elements__header" id="constants">
            Constants
            <a href="classes/Porta-Billing-Billing.html#constants" class="headerlink"><i class="fas fa-link"></i></a>
        </h3>
                    <article class="phpdocumentor-element -constant -public ">
    <h4 class="phpdocumentor-element__name" id="constant_DATETIME_FORMAT">
        DATETIME_FORMAT
        <a href="classes/Porta-Billing-Components-BillingBase.html#constant_DATETIME_FORMAT" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>

    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">29</span>

    </aside>

        <p class="phpdocumentor-summary">Billing API datetime format</p>

    <code class="phpdocumentor-signature phpdocumentor-code ">
    <span class="phpdocumentor-signature__visibility">public</span>
        <span class="phpdocumentor-signature__type">mixed</span>
    <span class="phpdocumentor-signature__name">DATETIME_FORMAT</span>
    = <span class="phpdocumentor-signature__default-value">&#039;Y-m-d H:i:s&#039;</span>
</code>


    
        <section class="phpdocumentor-description"></section>

    

</article>
            </section>

        

            <section class="phpdocumentor-methods">
        <h3 class="phpdocumentor-elements__header" id="methods">
            Methods
            <a href="classes/Porta-Billing-Billing.html#methods" class="headerlink"><i class="fas fa-link"></i></a>
        </h3>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method___construct">
        __construct()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method___construct" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">50</span>

    </aside>

        <p class="phpdocumentor-summary">Setup the class, load (if any) saved session state and get it ready to use</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">__construct</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><a href="classes/Porta-Billing-Interfaces-ConfigInterface.html"><abbr title="\Porta\Billing\Interfaces\ConfigInterface">ConfigInterface</abbr></a>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$config</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>On construct:</p>
<ul>
<li>Check the cached session token expire time within margin or left</li>
<li>If token expire soon (within configured margin), try to refresh token</li>
<li>If token expired or refresh failed - try to relogin if account data present,
throwing exceptions on failures.</li>
<li>If no accoount data present, just left the class un-logged-in, then you
need login() to get it connected</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$config</span>
                : <span class="phpdocumentor-signature__argument__return-type"><a href="classes/Porta-Billing-Interfaces-ConfigInterface.html"><abbr title="\Porta\Billing\Interfaces\ConfigInterface">ConfigInterface</abbr></a></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Configuration object to run</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_call">
        call()
        <a href="classes/Porta-Billing-Billing.html#method_call" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Billing.php"><a href="files/billing.html"><abbr title="Billing.php">Billing.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">107</span>

    </aside>

        <p class="phpdocumentor-summary">Perform billing API call.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">call</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$endpoint</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$params</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">[]</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"><p>Reference to your billing system API docs, located
at <strong>https://your-billing-sip-host/doc/api/</strong> or API section of Portaone
docs site <a href="https://docs.portaone.com/">https://docs.portaone.com/</a>. Mind your billing release version.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$endpoint</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>API endpoint as per docs, exapmle: '/Customer/get_customer_info'</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$params</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">[]</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>API requst params to put into &quot;params&quot; section</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaException.html"><abbr title="\Porta\Billing\Exceptions\PortaException">PortaException</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>on general errors</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaAuthException.html"><abbr title="\Porta\Billing\Exceptions\PortaAuthException">PortaAuthException</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>on auth-related errors</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaApiException.html"><abbr title="\Porta\Billing\Exceptions\PortaApiException">PortaApiException</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>on API returned an error</p>
</section>

                                    </dd>
                        </dl>

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span>
            &mdash;
            <section class="phpdocumentor-description"><p>Billing system answer, converted to associative array. If
billing retuns file, returns array with keys:</p>
<pre class="prettyprint"><code class="prettyprint">$returned = [
    'filename' =&gt; 'Invoice1234.pdf', // string, returned file name,
    'mime' =&gt; 'application/pdf',     // string, MIME file type
    'stream' =&gt; Stream               // PSR-7 stream object with file
];
</code></pre>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_callAsync">
        callAsync()
        <a href="classes/Porta-Billing-Billing.html#method_callAsync" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Billing.php"><a href="files/billing.html"><abbr title="Billing.php">Billing.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">218</span>

    </aside>

        <p class="phpdocumentor-summary">Performs async call to the billing and returns promise</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">callAsync</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$endpoint</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$params</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">[]</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"><p>This method is backend-dependent. In fact, it receives promise from client
adapter and wraps it with processResponse() to next promise and returns.</p>
<p>As a result, returned promise will contain processed billing response (array)
on fulfilled or throw proper exceptions in failures, behave the same way as
<abbr title="\Porta\Billing\method::call()">method::call()</abbr> method do.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$endpoint</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>API endpoint as per docs, exapmle: '/Customer/get_customer_info'</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$params</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">[]</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>API requst params to put into &quot;params&quot; section</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
            <section class="phpdocumentor-description"><p>backend-dependent 'thenable' promise</p>
<p>On fulfill, promise contains Billing system answer, converted to associative array. If
billing retuns file, returns array with keys:</p>
<pre class="prettyprint"><code class="prettyprint">$returned = [
    'filename' =&gt; 'Invoice1234.pdf', // string, returned file name,
    'mime' =&gt; 'application/pdf',     // string, MIME file type
    'stream' =&gt; Stream               // PSR-7 stream object with file
];
</code></pre>
<p>On reject, it will contain (and throw as unwrapped):</p>
<ul>
<li>PortaException on general errors</li>
<li>PortaAuthException on auth-related errors</li>
<li>PortaApiException on API returned an error</li>
</ul>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_callConcurrent">
        callConcurrent()
        <a href="classes/Porta-Billing-Billing.html#method_callConcurrent" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Billing.php"><a href="files/billing.html"><abbr title="Billing.php">Billing.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">148</span>

    </aside>

        <p class="phpdocumentor-summary">Perform bulk billig call, running multiple concurrent requests at once.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">callConcurrent</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">iteratable&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$operations</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$concurency</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">20</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

        <section class="phpdocumentor-description"><p>Method crawling recursively the traversable given to find all
<abbr title="\Porta\Billing\Interfaces\AsyncOperationInterface">AsyncOperationInterface</abbr> objects and then
process it in parallel with given concurrency (default 20). After run, the
objects filled with answers or exceptions depending of each separate call
results. it is safe as if there no object, it just do nothing silently,
but still do a session check call.</p>
<p><strong>Please, take care to ensure the session is up and warm.</strong> If session fail for
any reason, this metod <strong>will not relogin</strong> even credentials set. Therefore,
all the bundle of async calls will faile and array be populateed with auth
exceptions. If you can't be sure on session state, please use
<a href="classes/Porta-Billing-Billing.html#method_checkSession">checkSession()</a>
before call to ensure session is up and Ok. <strong>Do not trust to
<a href="classes/Porta-Billing-Billing.html#method_isSessionPresent">isSessionPresent()</a></strong>,
it only checks token state, it does not means the session OK on the server side.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$operations</span>
                : <span class="phpdocumentor-signature__argument__return-type">iteratable&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>array or any other multi-level iterable, containing
objects, implementing <abbr title="\Porta\Billing\AsyncOperationInterface">AsyncOperationInterface</abbr></p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$concurency</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                 = <span class="phpdocumentor-signature__argument__default-value">20</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>how much calls to run in parallel. Default is 20.</p>
<p><strong>WARNING: due of some reasons increasing of concurrency over some empiric
value does not decrease overall time to complete all the requests and even
make it longer. In fact, PHP does not support async operations, so all the
magic comes from cURL multi-call, so it could be combination of limitations:
cURL, PortaOne server and PHP itlself. As for me, 20 works fine.</strong></p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">void</span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_checkSession">
        checkSession()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method_checkSession" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">122</span>

    </aside>

        <p class="phpdocumentor-summary">Does active sesson check to billing server, relogin if required</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">checkSession</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

        <section class="phpdocumentor-description"><p>Completes 'Session/ping' call to check session state, then:</p>
<ul>
<li>If session not recognised, and credentials present, trying to relogin</li>
<li>If no credentials in config or login failure - throws auth exception</li>
</ul>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaAuthException.html"><abbr title="\Porta\Billing\Exceptions\PortaAuthException">PortaAuthException</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>on relogin failed or
no credentilas</p>
</section>

                                    </dd>
                        </dl>

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">void</span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_getUsername">
        getUsername()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method_getUsername" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">135</span>

    </aside>

        <p class="phpdocumentor-summary">Return current user login name</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">getUsername</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string|null</span></code>

        <section class="phpdocumentor-description"><p>Returns username taken from access token or null if no session is up</p>
</section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">string|null</span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_isSessionPresent">
        isSessionPresent()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method_isSessionPresent" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">106</span>

    </aside>

        <p class="phpdocumentor-summary">Returns true if session data exit and not expired</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">isSessionPresent</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"><p>Returns true if session data (token) exists and not expired, false if
not logged in for any reason.</p>
<p>Does not complete active sesion check to the server. Due of serveer configuratioin
issues token may be invalidated for inactivity before it's expire time really
has come. So, positive isSessionUp() only means persistent session data loaded,</p>
</section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">bool</span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_login">
        login()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method_login" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">73</span>

    </aside>

        <p class="phpdocumentor-summary">Do login and setup the session.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">login</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$account</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

        <section class="phpdocumentor-description"><p>The session data will be stored if session storage class is supplied</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$account</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Account record to login to the billing. Combination
of login+password or login+token required</p>
<pre class="prettyprint"><code class="prettyprint">$account = [
    'login' =&gt; 'myUserName',    // Mandatory username
    'password' =&gt; 'myPassword', // When login with password
    'token' =&gt; 'myToken'        // When login with API token
</code></pre>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaAuthException.html"><abbr title="\Porta\Billing\Exceptions\PortaAuthException">PortaAuthException</abbr></a></span>
                                                            
                                             
                                    </dd>
                        </dl>

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">void</span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_logout">
        logout()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method_logout" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">88</span>

    </aside>

        <p class="phpdocumentor-summary">Closes the session explicitly.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">logout</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">void</span></code>

        <section class="phpdocumentor-description"><p>Will call '/Session/logout' api method. Due of some problems with Portaone
resposes, session will considered closed whatever server respond. No server
error will be respected, but conenction errors will thrown.</p>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaConnectException.html"><abbr title="\Porta\Billing\Exceptions\PortaConnectException">PortaConnectException</abbr></a></span>
                                                            
                                             
                                    </dd>
                        </dl>

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">void</span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_makeRequest">
        makeRequest()
        <a href="classes/Porta-Billing-Billing.html#method_makeRequest" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Billing.php"><a href="files/billing.html"><abbr title="Billing.php">Billing.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">78</span>

    </aside>

        <p class="phpdocumentor-summary">Creates PSR-7 Request object for API call</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                    <span class="phpdocumentor-signature__name">makeRequest</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$endpoint</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$params</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">[]</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\Psr\Http\Message\RequestInterface">RequestInterface</abbr></span></code>

        <section class="phpdocumentor-description"><p>Creates Request with all necessaly elements could be send to the billing
API: endpoint, data, auth headers and all other.</p>
<p>This used for all other functions, but you may also got request, send it
with some specific client, async, multitread, wrap or whatever else, and
then got Respose object and process the response with static processResponse()
method below. all the processing sounds like:</p>
<pre class="prettyprint"><code class="prettyprint">// Creating PSR-7 HTTP Request object
$request = $billing-&gt;makeRequest(
                      '/Section/get_something_info', // Endpoint
                      ['i_something' =&gt; 42]          // Params
);

// Perform call with PSR-18 HTTP client
$response = $client-&gt;sendRequest($request);

// Parse response, extract data or files, handle errors
$result = Billing::processResponse($response);
</code></pre>
<p>Reference to your billing system API docs, located
at <strong>https://your-billing-sip-host/doc/api/</strong> or API section of Portaone
docs site <a href="https://docs.portaone.com/">https://docs.portaone.com/</a>. Mind your billing release version.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$endpoint</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>billing API endpoint</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$params</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">[]</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>API request params to put into &quot;params&quot; section</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type"><abbr title="\Psr\Http\Message\RequestInterface">RequestInterface</abbr></span>
            &mdash;
        
    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_processResponse">
        processResponse()
        <a href="classes/Porta-Billing-Billing.html#method_processResponse" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Billing.php"><a href="files/billing.html"><abbr title="Billing.php">Billing.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">269</span>

    </aside>

        <p class="phpdocumentor-summary">Process billing response, given as Response object</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">processResponse</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\Psr\Http\Message\ResponseInterface">ResponseInterface</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$response</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"><p>The full response nadling be provided, includint throwing exceptions on
different errors, if any.</p>
<p>Companion function to makeRequest(). All the processing sounds like:</p>
<pre class="prettyprint"><code class="prettyprint">// Creating PSR-7 HTTP Request object
$request = $billing-&gt;makeRequest(
                      '/Section/get_something_info', // Endpoint
                      ['i_something' =&gt; 42]          // Params
);

// Perform call with PSR-18 HTTP client
$response = $client-&gt;sendRequest($request);

// Parse response, extract data or files, handle errors
$result = Billing::processResponse($response);
</code></pre>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$response</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\Psr\Http\Message\ResponseInterface">ResponseInterface</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>object got from the biliing as answer</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaException.html"><abbr title="\Porta\Billing\Exceptions\PortaException">PortaException</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>on general errors</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaAuthException.html"><abbr title="\Porta\Billing\Exceptions\PortaAuthException">PortaAuthException</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>on auth-related errors</p>
</section>

                                    </dd>
                            <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">throws</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                <span class="phpdocumentor-tag-link"><a href="classes/Porta-Billing-Exceptions-PortaApiException.html"><abbr title="\Porta\Billing\Exceptions\PortaApiException">PortaApiException</abbr></a></span>
                                                            
                                                 <section class="phpdocumentor-description"><p>on API returned an error</p>
</section>

                                    </dd>
                        </dl>

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span>
            &mdash;
            <section class="phpdocumentor-description"><p>billing answer, converted to associative array</p>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_timeToBilling">
        timeToBilling()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method_timeToBilling" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">197</span>

    </aside>

        <p class="phpdocumentor-summary">Return billing API string at UTC fro given Datetime object</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">timeToBilling</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\DateTimeInterface">DateTimeInterface</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$time</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>The DateTime obhject given will not change.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$time</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\DateTimeInterface">DateTimeInterface</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Datetime object to take time from</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">string</span>
            &mdash;
            <section class="phpdocumentor-description"><p>Billing API-type datetime string, shifted to UTC</p>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                    -static                    "
>
    <h4 class="phpdocumentor-element__name" id="method_timeToLocal">
        timeToLocal()
        <a href="classes/Porta-Billing-Components-BillingBase.html#method_timeToLocal" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="Components/BillingBase.php"><a href="files/components-billingbase.html"><abbr title="Components/BillingBase.php">BillingBase.php</abbr></a></abbr>
    :
    <span class="phpdocumentor-element-found-in__line">183</span>

    </aside>

        <p class="phpdocumentor-summary">Convert billing-supplied UTC time string to DateTime object with target
timezone</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
            <span class="phpdocumentor-signature__static">static</span>        <span class="phpdocumentor-signature__name">timeToLocal</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$billingTime</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$timezone</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;UTC&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\DateTime">DateTime</abbr></span></code>

    
        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$billingTime</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><ul>
<li>datetime string as billing returns</li>
</ul>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$timezone</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;UTC&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><ul>
<li>timezone string like 'Europe/London&quot; or '+3000',
as defined at https://www.php.net/manual/en/datetimezone.construct.php</li>
</ul>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type"><abbr title="\DateTime">DateTime</abbr></span>
            &mdash;
        
    
</article>
            </section>

        
    <script type="text/javascript">
        function loadExternalCodeSnippets(line) {
            Array.prototype.slice.call(document.querySelectorAll('pre[data-src]')).forEach((pre) => {
                var src = pre.getAttribute('data-src').replace( /\\/g, '/');
                var extension = (src.match(/\.(\w+)$/) || [, ''])[1];
                var language = 'php';

                var code = document.createElement('code');
                code.className = 'language-' + language;

                pre.textContent = '';

                pre.setAttribute('data-line', line)
                code.textContent = 'Loading…';

                pre.appendChild(code);

                var xhr = new XMLHttpRequest();

                xhr.open('GET', src, true);

                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4) {

                        if (xhr.status < 400 && xhr.responseText) {
                            code.textContent = xhr.responseText;

                            Prism.highlightElement(code);
                        }
                        else if (xhr.status >= 400) {
                            code.textContent = '✖ Error ' + xhr.status + ' while fetching file: ' + xhr.statusText;
                        }
                        else {
                            code.textContent = '✖ Error: File does not exist, is empty or trying to view from localhost';
                        }
                    }
                };

                xhr.send(null);
            });
        }

        var modals = document.querySelectorAll("[data-modal]");

        modals.forEach(function (trigger) {
            trigger.addEventListener("click", function (event) {
                //event.preventDefault();
                const modal = document.getElementById(trigger.dataset.modal);
                modal.classList.add("phpdocumentor-modal__open");
                loadExternalCodeSnippets(trigger.dataset.line)
                const exits = modal.querySelectorAll("[data-exit-button]");
                exits.forEach(function (exit) {
                    exit.addEventListener("click", function (event) {
                        event.preventDefault();
                        modal.classList.remove("phpdocumentor-modal__open");
                    });
                });
            });
        });
    </script>

    </article>
                <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
            </div>
        </div>
        <a href="classes/Porta-Billing-Billing.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/line-highlight/prism-line-highlight.min.js"></script>
</body>
</html>
